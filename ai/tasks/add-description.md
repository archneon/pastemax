````markdown
# Task: Add Optional Description to Prompt Sections

**Goal:**

We want to improve the guidance given to the AI model that processes the output generated by PasteMax. To achieve this, we will add an optional introductory description string at the beginning of each content section in the generated prompt. This description can contain meta-instructions or context about the section's content (e.g., emphasizing the importance of rules). The description should only appear if it's explicitly defined for a section.

**Implementation Plan:**

You need to modify three files in the `src` directory. **Do not modify `constants.js` in the project root.**

1.  **Update Type Definition (`src/types/promptConfigTypes.ts`):**

    - Locate the `PromptSectionDefinition` interface.
    - Add a new optional property `description` of type `string`.

    ```typescript
    // src/types/promptConfigTypes.ts
    export interface PromptSectionDefinition {
      id: string;
      name: string; // Name for markers (e.g., 'RULES', 'DOCUMENTATION')
      label: string; // Name for UI display (e.g., 'Rules', 'Docs')
      directory: string | null; // Relative path from project root for categorization (null for default)
      color: string; // CSS color string for UI
      removeMdcMetadata?: boolean; // If true, removes YAML frontmatter from .mdc files
      concatenateContent?: boolean; // If true, combines all files in the section into one block
      description?: string; // <-- ADD THIS LINE: Optional description for the section intro
    }
    ```

2.  **Update Frontend Constants (`src/constants.ts`):**

    - Locate the `PROMPT_SECTIONS` array.
    - Add the `description` property to the objects for `cursor_rules` (STANDARD_RULES) and `rules` (DETAILED_RULES) sections with the specified meta-instruction text. You can potentially add descriptions to other sections later if needed.

    ```typescript
    // src/constants.ts
    // ... (other constants)

    export const PROMPT_SECTIONS: PromptSectionDefinition[] = [
      {
        id: "cursor_rules",
        name: "STANDARD_RULES",
        label: "Cursor Rules",
        directory: ".cursor/rules",
        color: "var(--accent-green)",
        removeMdcMetadata: true,
        concatenateContent: true,
        // <-- ADD THIS description property and value
        description:
          "// META-INSTRUCTION: The following are critical project rules provided by Cursor. Adhere to them strictly.",
      },
      {
        id: "rules",
        name: "DETAILED_RULES",
        label: "Rules",
        directory: "ai/rules",
        color: "var(--warning-color)",
        removeMdcMetadata: true,
        concatenateContent: true,
        // <-- ADD THIS description property and value
        description:
          "// META-INSTRUCTION: The following are detailed project-specific rules. Adhere to them strictly.",
      },
      {
        id: "scraped",
        name: "SCRAPED_DOCUMENTATION",
        label: "Scraped Docs",
        directory: "ai/scraped",
        color: "var(--success-color)",
        // No description added here for now
      },
      {
        id: "docs",
        name: "PROJECT_DOCUMENTATION",
        label: "Project Docs",
        directory: "ai/docs",
        color: "var(--accent-purple)",
        // No description added here for now
      },
      {
        id: "project_files", // Default section
        name: "PROJECT_FILES",
        label: "Project",
        directory: null, // Indicates this is the default/fallback
        color: "var(--accent-blue)",
        // No description added here for now
      },
      {
        id: "prompts",
        name: "PROMPTS",
        label: "Prompts",
        directory: "ai/prompts",
        color: "var(--error-color)",
        // No description added here for now
      },
    ];
    ```

3.  **Adjust Prompt Generation Logic (`src/utils/promptUtils.ts`):**

    - Locate the `generatePromptContent` function.
    - Find the `for...of` loop that iterates through `PROMPT_SECTIONS`.
    - **Immediately after** the line that adds the `section_open` marker (`mainOutput += formatMarker(...) + "\n\n";`), insert the logic to check for and append the `section.description`. Ensure there are two newline characters (`\n\n`) after the description for proper spacing before the actual content.
    - Make sure the rest of the logic (handling concatenated vs. individual files) correctly adds `\n\n` after its content block as well, before the `section_close` marker.

    ```typescript
    // src/utils/promptUtils.ts
    // ... inside generatePromptContent function ...

    // Add sections to the output
    for (const section of PROMPT_SECTIONS) {
      const sectionFiles = filesBySection[section.id];
      if (!sectionFiles || sectionFiles.length === 0) continue;

      presentSectionNames.add(section.name);

      // Add section start marker (ensure two newlines after)
      mainOutput +=
        formatMarker(PROMPT_MARKERS.section_open, {
          section_name: section.name,
        }) + "\n\n";

      // --- ADD THIS BLOCK ---
      // Check if a description exists and add it
      if (section.description && section.description.trim().length > 0) {
        mainOutput += section.description.trim() + "\n\n"; // Add description and two newlines
      }
      // --- END OF ADDED BLOCK ---

      // Handle concatenated content
      if (section.concatenateContent) {
        logger.debug(`Concatenating content for section: ${section.name}`);
        let combinedContent = "";
        sectionFiles.forEach((file) => {
          let fileContent = file.content || "";
          if (section.removeMdcMetadata && file.name.endsWith(".mdc")) {
            fileContent = removeMdcFrontmatter(fileContent);
          }
          if (combinedContent.length > 0) {
            combinedContent += "\n\n---\n\n";
          }
          combinedContent += fileContent.trim();
        });

        if (combinedContent.length > 0) {
          // Add combined content and ensure two newlines after
          mainOutput += combinedContent + "\n\n";
        }
      } else {
        // Handle individual files
        sectionFiles.forEach((file) => {
          let fileContent = file.content || "";
          if (section.removeMdcMetadata && file.name.endsWith(".mdc")) {
            fileContent = removeMdcFrontmatter(fileContent);
          }
          const relativePath = getRelativePath(file.path, selectedFolder);
          mainOutput +=
            formatMarker(PROMPT_MARKERS.file_open, {
              file_path: relativePath,
            }) + "\n";
          mainOutput += fileContent; // Add file content
          if (fileContent && !fileContent.endsWith("\n")) mainOutput += "\n"; // Ensure newline at end of content
          mainOutput +=
            formatMarker(PROMPT_MARKERS.file_close, {
              file_path: relativePath,
            }) + "\n\n"; // Two newlines after file block
        });
      }

      // Add section end marker (ensure two newlines after)
      mainOutput +=
        formatMarker(PROMPT_MARKERS.section_close, {
          section_name: section.name,
        }) + "\n\n";
    } // End of for...of loop

    // ... rest of the function ...
    ```

**Testing Guidance:**

1.  After applying the changes, run the application.
2.  Select a project folder.
3.  Select files that fall into the `STANDARD_RULES` (`.cursor/rules/...`) and/or `DETAILED_RULES` (`ai/rules/...`) sections. Also select some regular project files (e.g., from `src/`).
4.  Click the "COPY" button.
5.  Paste the result and verify:
    - The `// META-INSTRUCTION...` lines appear immediately after the `@@@@_STANDARD_RULES_START` and `@@@@_DETAILED_RULES_START` markers, respectively.
    - There is a blank line between the description and the actual file content (or the start of the first file marker in non-concatenated sections).
    - Sections without a defined `description` (like `PROJECT_FILES`) do _not_ have any extra text added after their `_START` marker.
    - The overall formatting with blank lines between sections and file blocks remains correct.
````
